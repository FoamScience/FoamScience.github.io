<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Customize VIM to work efficiently with OpenFOAM - Part 2 « FOAM Science; Doing CFD</title>
  <meta name="description" content="We’ve seen in the previous partsome ways to improve our interaction withOpenFOAM case directories and files.In this new post, we want to implement something ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/vim-openfoam-power-part2/">
  <link rel="alternate" type="application/rss+xml" title="FOAM Science; Doing CFD" href="http://localhost:4000/feed.xml" />
   <!-- Analytics -->
 <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', '','auto');
  ga('send', 'pageview');</script>

  
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
  (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-3635214305281166",
              enable_page_level_ads: true
                    });
    </script>


</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">FOAM Science; Doing CFD</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/">Home</a>
      
        
        <a class="page-link" href="/about/">About</a>
      
        
        <a class="page-link" href="/contact/">Contact</a>
      
        
        <a class="page-link" href="/category/">Category</a>
      
        
        <a class="page-link" href="/tags/">Tags</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Customize VIM to work efficiently with OpenFOAM - Part 2</h1>
    <p class="post-meta">Aug 28, 2018</p>
  </header>

  <article class="post-content">
    <p>We’ve seen in <a href="/vim-openfoam-power-part1">the previous part</a>
some ways to improve our interaction with
OpenFOAM case directories and files.
In this new post, we want to implement something that facilitates
running <code class="highlighter-rouge">blockMesh</code>, or the case solver, right from inside VIM; without going back to the shell.
Of course, our implementation should catch errors in the quick fix list (if there are any), 
then go to the concerned file, and put the cursor on the error line.
<!--more--></p>

<ul id="markdown-toc">
  <li><a href="#studying-an-example-vim-compiler" id="markdown-toc-studying-an-example-vim-compiler">Studying an example VIM compiler</a>    <ul>
      <li><a href="#using-errorformats-to-catch-openfoam-fatal-errors" id="markdown-toc-using-errorformats-to-catch-openfoam-fatal-errors">Using errorformats to catch OpenFOAM Fatal Errors</a></li>
    </ul>
  </li>
  <li><a href="#building-a-compiler-plugin-for-blockmesh" id="markdown-toc-building-a-compiler-plugin-for-blockmesh">Building a compiler plugin for blockMesh</a></li>
  <li><a href="#use-foamgetapplication-to-get-solver-name" id="markdown-toc-use-foamgetapplication-to-get-solver-name">Use FOAMGetApplication to get solver name</a></li>
  <li><a href="#the-general-vim-compiler-plugin-for-openfoam" id="markdown-toc-the-general-vim-compiler-plugin-for-openfoam">The general VIM compiler plugin for OpenFOAM</a></li>
  <li><a href="#final-tweaks-vims-auto-commands" id="markdown-toc-final-tweaks-vims-auto-commands">Final tweaks: VIM’s auto-commands</a></li>
</ul>

<p>For this, we’ll use two main VIM facilities: <em>VIM compilers</em> and <em>QuickFix</em> list.
The compilers are used to automatically run a shell command on a file; For example:</p>
<ul>
  <li>Running a <code class="highlighter-rouge">gcc</code> (or <code class="highlighter-rouge">make</code> if there is a <em>makeFile</em>) command on a <code class="highlighter-rouge">*.cpp</code> file would compile it
to an executable,</li>
  <li>Running a <code class="highlighter-rouge">pdflatex</code> (or better <code class="highlighter-rouge">latexmk</code>) command on a <em>Latex file</em> would compile
a PDF version of the document.</li>
  <li>Running a <code class="highlighter-rouge">blockMesh</code> command on a <em>blockMeshDict</em> would build the mesh and check
for errors in <code class="highlighter-rouge">blockMesh</code>’s output.</li>
</ul>

<p>In fact, we can run as many commands as we want on the file using VIM compilers.
Think: Generate the mesh, check its validity, set fields and run appropriate solvers
(In my opinion, this kind of work-flows beats GUIs to death).</p>

<p>So, let’s get to work: We need to know how VIM’s default compiler plugins are set, 
and the best way to learn is by looking at examples. On Unix systems, the default compilers should be
in <code class="highlighter-rouge">/usr/share/vim/vim74/compiler</code> directory, you can use VIM’s ex-command <code class="highlighter-rouge">:compile</code> to find out where 
they are on your system.</p>

<h2 id="studying-an-example-vim-compiler">Studying an example VIM compiler</h2>

<p>First of all, a VIM compiler plugin is nothing more than a short <code class="highlighter-rouge">VimL</code> script, configuring two
main things: <code class="highlighter-rouge">errorformat</code> (scanf-style strings, separated by commas, showing the
format of error lines) and <code class="highlighter-rouge">makeprg</code> (make program, the shell executable to run).</p>

<p>As an example, let’s go through the <em>ant-compiler</em> line by line:</p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">" Vim Compiler File</span>
<span class="c">" Compiler:	ant</span>
<span class="c">" Maintainer:	Johannes Zellner &lt;johannes@zellner.org&gt;</span>
<span class="c">" Last Change:	Mi, 13 Apr 2005 22:50:07 CEST</span>
</code></pre></div></div>

<p>The header, just for information, then we have some checks to perform:</p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> exists<span class="p">(</span><span class="s2">"current_compiler"</span><span class="p">)</span>
    <span class="k">finish</span>
<span class="k">endif</span>
<span class="k">let</span> current_compiler <span class="p">=</span> <span class="s2">"ant"</span>

<span class="k">if</span> exists<span class="p">(</span><span class="s2">":CompilerSet"</span><span class="p">)</span> <span class="p">!=</span> <span class="m">2</span>		" older Vim always used <span class="p">:</span><span class="k">setlocal</span>
  command <span class="p">-</span>nargs<span class="p">=</span>* CompilerSet <span class="k">setlocal</span> <span class="p">&lt;</span>args<span class="p">&gt;</span>
<span class="k">endif</span>

</code></pre></div></div>

<p>The first if structure checks if the compiler is already set (if it’s the case, vim will leave the script). 
If not, it
declares <code class="highlighter-rouge">current_compiler</code> as <em>“ant”</em> (so, the next time the script executes, it will be finished in
the first if structure). The second if statement sets compatibility stuff for older VIM
versions.</p>

<p>All the <code class="highlighter-rouge">cpo</code>-related stuff are set to configure Vi-compatibility options, we don’t need to
learn about this topic, just don’t touch those lines!</p>

<p>The line <code class="highlighter-rouge">CompilerSet makeprg=ant</code> sets the ant program as the make program (when
you execute the ex-command <code class="highlighter-rouge">:make</code>, VIM runs <code class="highlighter-rouge">ant</code> in a shell, and watches for its output).</p>

<p><code class="highlighter-rouge">CompilerSet errorformat=\ %#[%.%#]\ %#%f:%l:%v:%*\\d:%*\\d:\%t%[%^:]%#:%m</code>
shows VIM how to find the error line and what to extract from it (explained in more
details in the next section).</p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">s:cpo_save</span> <span class="p">=</span> &amp;cpo
<span class="k">set</span> cpo&amp;<span class="k">vim</span>

CompilerSet makeprg<span class="p">=</span>ant

<span class="c">" first  line:</span>
<span class="c">"     ant with jikes +E, which assumes  the following</span>
<span class="c">"     two property lines in your 'build.xml':</span>
<span class="c">"</span>
<span class="c">"         &lt;property name = "build.compiler"       value = "jikes"/&gt;</span>
<span class="c">"         &lt;property name = "build.compiler.emacs" value = "true"/&gt;</span>
<span class="c">"</span>
<span class="c">" second line:</span>
<span class="c">"     ant with javac</span>
<span class="c">"</span>
<span class="c">" note that this will work also for tasks like [wtkbuild]</span>
<span class="c">"</span>
CompilerSet errorformat<span class="p">=</span>\ %#<span class="p">[</span>%<span class="p">.</span>%#<span class="p">]</span>\ %#%<span class="k">f</span><span class="p">:</span>%<span class="k">l</span><span class="p">:</span>%<span class="k">v</span><span class="p">:</span>%*\\<span class="k">d</span><span class="p">:</span>%*\\<span class="k">d</span><span class="p">:</span>\ %<span class="k">t</span>%<span class="p">[</span>%^<span class="p">:]</span>%#<span class="p">:</span>%<span class="k">m</span><span class="p">,</span>
<span class="se">    \</span>%A\ %#<span class="p">[</span>%<span class="p">.</span>%#<span class="p">]</span>\ %<span class="k">f</span><span class="p">:</span>%<span class="k">l</span><span class="p">:</span>\ %<span class="k">m</span><span class="p">,</span>%<span class="p">-</span>Z\ %#<span class="p">[</span>%<span class="p">.</span>%#<span class="p">]</span>\ %<span class="k">p</span>^<span class="p">,</span>%C\ %#<span class="p">[</span>%<span class="p">.</span>%#<span class="p">]</span>\ %#%<span class="k">m</span>

<span class="c">" ,%-C%.%#</span>

<span class="k">let</span> &amp;cpo <span class="p">=</span> <span class="nv">s:cpo_save</span>
unlet <span class="nv">s:cpo_save</span>
</code></pre></div></div>

<h3 id="using-errorformats-to-catch-openfoam-fatal-errors">Using errorformats to catch OpenFOAM Fatal Errors</h3>

<p>These <em>errorformats</em> are similar to regular expressions. Assume a program outputting errors in the
following format:</p>

<p><code class="highlighter-rouge">Error: something-is-wrong in /path/to/file at line 25</code></p>

<p>To match this error line, we use a single scanf-style string, that may contain special
items (these are the most important ones):</p>
<ul>
  <li><code class="highlighter-rouge">%f</code> matches a file name (a string), eg. <em>/path/to/file</em></li>
  <li><code class="highlighter-rouge">%l</code> matches a line number (digits), eg. <em>25</em></li>
  <li><code class="highlighter-rouge">%m</code> matches an error message, eg. <em>something-is-wrong</em></li>
  <li><code class="highlighter-rouge">%*{conv}</code> converts stuff from regexp to scanf string, eg. %*[a-z] matches any number
of lowercase alphabets.</li>
</ul>

<p>Thus, the example line would be matched with <code class="highlighter-rouge">\Error: %m in %f at line %l</code></p>

<h2 id="building-a-compiler-plugin-for-blockmesh">Building a compiler plugin for blockMesh</h2>

<p>The goal of this section is to build a blockMesh-compiler for VIM which can be used to
browse errors when the tool fails. For this, we need to create our custom-compilers directory
<code class="highlighter-rouge">$HOME/.vim/compiler</code>.</p>

<p>Copy the <code class="highlighter-rouge">ant.vim</code> compiler to that directory and rename it as <code class="highlighter-rouge">blockMesh.vim</code>, on Unix
systems, one can say:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp /usr/share/vim/vim74/compiler/ant.vim ~/.vim/compiler/blockMesh.vim
</code></pre></div></div>

<p>Modify the header so it suits your preferences, and then start building the custom VIM compiler:</p>
<ul>
  <li>Hopefully, you are editing the file with VIM.</li>
  <li>Change all occurrences of “<em>ant</em>” to “<em>blockMesh</em>” in the file <code class="highlighter-rouge">:%s/ant/blockMesh/g</code></li>
  <li>Time to set the “errorformat”: We know that OpenFOAM displays errors in multiple
lines (if you write “hxe” instead of “hex” in a <em>blockMeshDict</em>):</li>
</ul>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--&gt; FOAM FATAL IO ERROR:
CellShape has unknown model on line 45 the word 'hxe'
file: /home/elwardi/OpenFOAM/elwardi-4.1/run/movingCone/system/blockMeshDict.blocks at line 45.
</code></pre></div></div>

<p>Note that this is NOT a general FOAM ERROR; some other IO errors specify a range
of lines; others suggest solutions before stating the error-line.</p>

<p>The most important line is probably the one stating
the filename, and the exact line to jump to (these will be stored
in <code class="highlighter-rouge">%f</code> and <code class="highlighter-rouge">%l</code> respectively).However, there are some problems in the filename:
notice the ending <code class="highlighter-rouge">.blocks</code> appended to it, in fact, things could be messier:
<code class="highlighter-rouge">.ddtschemes.default</code>.</p>

<p>How many dots are there in the filename? The real problem is that the <code class="highlighter-rouge">path/to/case</code>
always contains a dot character (frrom the OpenFOAM version, eg. user-4.1), so matching
from the start of the path to the first dot character won’t work!</p>

<p>Instead, we do notice that versions are expressed in digits, and that case names
usually contain no dots (hopefully); so, matching the path up to the first dot character preceding
an alphabet character is a good idea:
<code class="highlighter-rouge">CompilerSet errorformat=\file:\ %f\.%[a-z]%*[a-z\ ]\ line\ %l\.</code></p>

<ul>
  <li><code class="highlighter-rouge">%f</code> matches the string “file: “ at the start of line, then starts storing the 
filename up to the first dot that falls immediately before a lowercase alphabet character 
(hopefully, that’s the keyword <code class="highlighter-rouge">.blocks</code>, or <code class="highlighter-rouge">.fvSchemes</code> …). Then we’ll have 
some lowercase characters and spaces until we reach the last line before “line” string, 
then <code class="highlighter-rouge">%l</code> catches the line number (in case there are two, it catches the last one!).</li>
</ul>

<p>Now, what to tell the user? Well, It’s good to have a message at the status line
saying “<em>CellShape has unknown model …</em>”, so, we should use a complex multi-line
<em>errorformat</em>! But, still we’ll have to deal with the problem of how many lines are
there between the line that tells our message and the line that spells out the error line.</p>

<p>This is actually troublesome, so, I’ve decided to approach the situation differently: 
We leave our filename and error-line alone, and add another error that captures only the
message (using a simple multi-line error-format).</p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CompilerSet errorformat<span class="p">=</span>\<span class="k">file</span><span class="p">:</span>\ %<span class="k">f</span>\<span class="p">.</span>%<span class="p">[</span><span class="k">a</span><span class="p">-</span>z<span class="p">]</span>%*<span class="p">[</span><span class="k">a</span><span class="p">-</span>z\ <span class="p">]</span>\ line\ %<span class="k">l</span>\<span class="p">.</span>
<span class="se">                        \</span>%E<span class="p">--&gt;</span>\ %*<span class="p">[</span>A<span class="p">-</span>Z<span class="p">:</span>\ <span class="p">],</span>%Z%<span class="k">m</span>
</code></pre></div></div>

<ul>
  <li><code class="highlighter-rouge">%E</code> denotes the start of a multi-line error.</li>
  <li>Then we find the line saying <code class="highlighter-rouge">Fatal IO Error</code> (starts with –&gt; then there are some
uppercase letters,semicolons, and spaces).</li>
  <li><code class="highlighter-rouge">%Z</code> denotes the end of multi-line error (which is only one line here!) then
 we capture everything in the second line as a <code class="highlighter-rouge">%m</code> (an error message).</li>
</ul>

<p>The compiler plugin is now complete:</p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">" Vim Compiler File</span>
<span class="c">" Compiler: blockMesh</span>
<span class="c">" Fadeli Mohammed Elwardi &lt;foamscience.github.io&gt;</span>

<span class="k">if</span> exists<span class="p">(</span><span class="s2">"current_compiler"</span><span class="p">)</span>
<span class="k">finish</span>
<span class="k">endif</span>

<span class="k">let</span> current_compiler <span class="p">=</span> <span class="s2">"blockMesh"</span>

<span class="k">if</span> exists<span class="p">(</span><span class="s2">":CompilerSet"</span><span class="p">)</span> <span class="p">!=</span> <span class="m">2</span>
<span class="c">" older Vim always used :setlocal</span>
command <span class="p">-</span>nargs<span class="p">=</span>* CompilerSet <span class="k">setlocal</span> <span class="p">&lt;</span>args<span class="p">&gt;</span>
<span class="k">endif</span>

<span class="k">let</span> <span class="nv">s:cpo_save</span> <span class="p">=</span> &amp;cpo
<span class="k">set</span> cpo&amp;<span class="k">vim</span>

CompilerSet makeprg<span class="p">=</span>blockMesh

CompilerSet errorformat<span class="p">=</span>
<span class="se">                 \</span>\<span class="k">file</span><span class="p">:</span>\ %<span class="k">f</span>\<span class="p">.</span>%<span class="p">[</span><span class="k">a</span><span class="p">-</span>z<span class="p">]</span>%*<span class="p">[</span><span class="k">a</span><span class="p">-</span>z\ <span class="p">]</span>\ line\ %<span class="k">l</span>\<span class="p">.,</span>
<span class="se">                 \</span>%E<span class="p">-&gt;</span>\ %*<span class="p">[</span>A<span class="p">-</span>Z<span class="p">:</span>\ <span class="p">],</span>%Z%<span class="k">m</span>

<span class="k">let</span> &amp;cpo <span class="p">=</span> <span class="nv">s:cpo_save</span>
unlet <span class="nv">s:cpo_save</span>
</code></pre></div></div>

<p>And you should be ready to test it with a sample (erroneous) <code class="highlighter-rouge">blockMeshDict</code>:</p>
<ol>
  <li>Make something of importance go wrong in a <code class="highlighter-rouge">blockMeshDict</code> (the last ; in a block is
not that important).</li>
  <li>While editing <code class="highlighter-rouge">blockMeshDict</code>, run <code class="highlighter-rouge">:compile blockMesh</code> to set the correct compiler
(We’ll improve on this).</li>
  <li>Hopefully your working directory is set by our previous <code class="highlighter-rouge">customFoam</code> script, if it
is the case, run the ex-command <code class="highlighter-rouge">:make</code> and check that beautiful (and useful) error
message!</li>
  <li>To automatically jump to the error line, type <code class="highlighter-rouge">:cn</code> (short of cnext).</li>
</ol>

<blockquote>
  <p>The error format can’t handle “from line 15 to line 18.” lines, because no file path
will be output in such lines!</p>
</blockquote>

<p>Now that VIM knows how to handle <code class="highlighter-rouge">blockMesh</code>, let’s introduce it to the other FOAM applications 
(we’ll be doing just solvers for illustration). Wait, should we repeat the work done previously tens
of times? Absolutely not.</p>

<p>The goal of this blog post is to achieve this work-flow:</p>
<ol>
  <li>When I read in a FOAM File, VIM changes its working dir. to case dir.
(already implemented in <code class="highlighter-rouge">customFoam.vim</code>, see 
<a href="/vim-openfoam-power-part1">this earlier post</a>)</li>
  <li>VIM looks for the suitable OpenFOAM solver for the current case (mentioned in <code class="highlighter-rouge">controlDict</code>).</li>
  <li>VIM sets the right solver as the <code class="highlighter-rouge">makeprg</code> automatically.</li>
  <li>When I run <code class="highlighter-rouge">:make</code> (Or press a shortcut to it), VIM will filter the output to 
show me the errors if there are any.</li>
</ol>

<p>One more thing, I want my own solvers to be involved, so, I won’t generate a list of
standard solvers and compare anything to its content. That’s one lousy approach to take!</p>

<p>Instead, I’m going to define two functions: The first one, in <code class="highlighter-rouge">customFoam.vim</code>, which searches
and stores the solver name, and the second sets the option <code class="highlighter-rouge">makeprg</code> dynamically in a
general compiler plugin called <code class="highlighter-rouge">foam.vim</code>.</p>

<h2 id="use-foamgetapplication-to-get-solver-name">Use FOAMGetApplication to get solver name</h2>

<p>From any file in the case dir., we can tell VIM what solver is to be used with the current
case because it’s mentioned in the <code class="highlighter-rouge">controlDict</code> file. Actually, we have two options
here:</p>
<ul>
  <li>Use VIM to take a look at <code class="highlighter-rouge">controlDict</code>, and store a string representing the solver name.</li>
  <li>Or, do it the FOAM way (use run functions: <code class="highlighter-rouge">getApplication</code>), which needs a working
Installation of OpenFOAM (but that’s Ok, you won’t be reading this guide otherwise).
This method is heavily used in .Allrun shell scripts.</li>
</ul>

<p>In order to learn how VIM interacts with the system, we’ll use the second option: We’ll
add a <code class="highlighter-rouge">FOAMGetApplication()</code> function to our <code class="highlighter-rouge">customFoam.vim</code></p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="p">!</span> FOAMGetApplication<span class="p">()</span>
    <span class="c">" Source run functions and execute getApplication</span>
    <span class="k">let</span> cmd<span class="p">=</span><span class="s2">". $WM_PROJECT_DIR/bin/tools/RunFunctions &amp;&amp; getApplication"</span>
    <span class="k">let</span> foamApp<span class="p">=</span>system<span class="p">(</span>cmd<span class="p">)[:</span><span class="m">-2</span><span class="p">]</span>
    <span class="k">echomsg</span> <span class="s1">'This case is set to be simulated with: '</span><span class="p">.</span>foamApp
    <span class="k">return</span> foamApp
<span class="k">endfunction</span>
</code></pre></div></div>

<ul>
  <li><code class="highlighter-rouge">cmd</code> is a string, representing the shell command that sources run functions and then
executes <code class="highlighter-rouge">getApplication</code> in the current case dir.</li>
  <li><code class="highlighter-rouge">foamApp</code> is the output of the previous command (solver name), the <code class="highlighter-rouge">[:-2]</code> part deletes
the last two characters from the output of the command (by default, It will output
<code class="highlighter-rouge">icoFoam @</code>, the last two characters are not needed).</li>
  <li><code class="highlighter-rouge">echomsg</code> writes messages to the status line, and keeps them in messages list 
(run <code class="highlighter-rouge">:messages</code>).</li>
</ul>

<h2 id="the-general-vim-compiler-plugin-for-openfoam">The general VIM compiler plugin for OpenFOAM</h2>

<p>Copy <code class="highlighter-rouge">blockMesh.vim</code> to <code class="highlighter-rouge">foam.vim</code>.</p>
<ul>
  <li>Don’t forget <code class="highlighter-rouge">let current_compiler = "foam"</code></li>
  <li>Declare a script variable, storing the solver name
<code class="highlighter-rouge">let s:foamApp = FOAMGetApplication()</code></li>
  <li>Instead of <code class="highlighter-rouge">CompilerSet</code>, define a new function setting the compiler to the solver
name, then call it.</li>
</ul>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="p">!</span> FOAMSetCompiler<span class="p">()</span>
    exe <span class="s1">'CompilerSet makeprg='</span><span class="p">.</span><span class="nv">s:foamApp</span>
<span class="k">endfunction</span>
<span class="k">call</span> FOAMSetCompiler<span class="p">()</span>
</code></pre></div></div>

<ul>
  <li>For the file line in the error format, use
<code class="highlighter-rouge">\\file:\ %f\.%*[a-zA-Z]%*[a-zA-Z\ .]\ line\ %l%*[.a-zA-Z0-9\ ]</code>
So we can cover stuff like “from line 15 to line 20.” and be more dynamic with the
number of dots in the filename (handle things like <code class="highlighter-rouge">0/U.boundaryField.inlet</code>).
Done!! We are ready to go!</li>
</ul>

<h2 id="final-tweaks-vims-auto-commands">Final tweaks: VIM’s auto-commands</h2>

<p>We only need to tell VIM to set the compiler to “foam” whenever a Foam File is opened;
and to set the compiler to <code class="highlighter-rouge">blockMesh</code> if the entered buffer is named <code class="highlighter-rouge">blockMeshDict</code>.</p>

<div class="language-vim highlighter-rouge"><div class="highlight"><pre class="highlight"><code>augroup FOAMautocmds
autocmd<span class="p">!</span>
autocmd <span class="nb">FileType</span> foam* <span class="k">call</span> FOAMSetPathToCaseDir<span class="p">()</span>
autocmd <span class="nb">FileType</span> foam* <span class="k">compile</span> foam
autocmd <span class="nb">BufEnter</span> *blockMeshDict <span class="k">compile</span> blockMesh
augroup End
</code></pre></div></div>

<blockquote>
  <p><em>FileType</em> autocmds will <em>always</em> be executed before <em>BufEnter</em> ones, so <code class="highlighter-rouge">blockMeshDict</code> files
will always have <code class="highlighter-rouge">blockMesh</code> as their compiler.</p>
</blockquote>

<p>The complete configuration files can be downloaded from here:</p>

<p><a href="https://drive.google.com/uc?id=1Sf-6Pm8twy8dM6YIcWZ8lMFaem2S2F0O&amp;export=download" class="btn">VIM Customization</a></p>

  </article>
  
  

<div class="post-comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      var disqus_shortname = 'foamscience'; // required: replace example with your forum shortname
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
</div>





</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="/assets/img/FoamScience/foamscience-logo-400x400-transparent.jpg" alt="M. Elwardi Fadeli">
  <div class="col-box-title name">M. Elwardi Fadeli</div>
  <p></p>
  <p class="contact">
    
    <a href="https://github.com/FoamScience">GitHub</a>
    
    
    
    <a href="mailto:elwardifadeli@gmail.com">Email</a>
    
    <a href="https://linkedin.com/in/elwardi-fadeli">LinkedIn</a>
    
  </p>
</div>

<div class="col-box">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- SideAds -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3635214305281166"
     data-ad-slot="8889675473"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

  <div class="col-box-title">Newest Posts</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/vim-openfoam-power-part2/">Customize VIM to work efficiently with OpenFOAM - Part 2</a></li>
    
      <li><a class="post-link" href="/vim-openfoam-power-part1/">Customize VIM to work efficiently with OpenFOAM - Part 1</a></li>
    
      <li><a class="post-link" href="/openscad-stock-tank-model/">Stock-Tank mesh construction using OpenSCAD</a></li>
    
      <li><a class="post-link" href="/openscad-cfd-usage-examples/">OpenSCAD CFD-oriented Usage Examples</a></li>
    
      <li><a class="post-link" href="/openscad-transformations-boolean-operations/">OpenSCAD Transformations & Boolean Operations</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">TOC</div>
</div>

        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 M. Elwardi Fadeli
</div>
<span><a href="/terms-of-use/">Terms Of Use</a></span>
<span>|</span>
<span><a href="/terms-of-use/">Privacy Policy</a></span>
<div>
<span>
    <span style="padding:20px;">
        <p
        style="display:block;margin-left:auto;margin-right:auto;width:500px;font-size:12px;"> 
  The <a href="http://www.openfoam.com/legal/trademark-policy.php">
      trade mark of the OPENFOAM</a> 
  name is held by <a href="http://openfoam.com/">ESI-OpenCFD</a>. 
  At the moment, this offering
  is not approved or endorsed by OpenCFD Limited, producer and distributor of the OpenFOAM
  software and owner of the OPENFOAM® and OpenCFD® trade marks. 
  </p>
  </span>     
</span>
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>


  </body>

</html>
